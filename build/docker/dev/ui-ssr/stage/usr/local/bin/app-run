#!/usr/bin/env sh

cd /ui

pid=0
pid_zero=0
script="dist-ssr/server.js"
last_dir_list=""

while true    
do
    if [ -f $script ]
    then
        dir_list=$(ls -le dist-ssr/*)
        if [ "$dir_list" != "$last_dir_list" ]
        then    
            if [ "$pid" -gt "$pid_zero" ] && [ -d "/proc/$pid" ]
            then
                kill $pid
                wait $pid
            fi
            node $script &
            pid=$!
            last_dir_list=$dir_list
        fi
    fi
   sleep 0.1
done
