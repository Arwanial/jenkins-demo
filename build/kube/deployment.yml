apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: dotvue-blog-alpha
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: dotvue-blog-alpha
    spec:
      containers:
      - name: nginx
        imagePullPolicy: Always
        image: gcr.io/caleb-lloyd/dotvue-blog-nginx:1
        env:
        - name: DEVENV
          value: alpha
        ports:
        - containerPort: 80
      - name: dotnet
        imagePullPolicy: Always
        image: gcr.io/caleb-lloyd/dotvue-blog-dotnet:1
        env:
        - name: DEVENV
          value: alpha
        ports:
        - containerPort: 5000
        volumeMounts:
        - name: dotvue-blog-db
          mountPath: /etc/secrets/dotvue-blog-db
          readOnly: true
      - name: ui-ssr
        imagePullPolicy: Always
        image: gcr.io/caleb-lloyd/dotvue-blog-ui-ssr:1
        env:
        - name: DEVENV
          value: alpha
        ports:
        - containerPort: 4000
      volumes:
      - name: dotvue-blog-db
        secret:
          secretName: dotvue-blog-db
